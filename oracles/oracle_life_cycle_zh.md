[back](./oracles.md)
## 预言机生命周期举例

### 以一场足球比赛结果为例

爱丽丝是一个足球迷，而且，她喜欢分享足球比赛的结果

爱丽丝通过向区块链提交预言机注册交易，注册了一个预言机

并且支付了一定的费用

爱丽丝需要提供一些信息，包括:

- 向她支付查询费用
- 查询格式声明
- 查询结果格式声明

当预言机交易被区块链处理时，预言机会被预言机状态树创建。

爱丽丝在网络中运行着一个节点，她在她本地节点上，注册了一个订阅，这样的话，一旦有人查阅了她的预言机，她就能获取通知。

bob 想知道区块链中某个特定比赛的结果。

然后，他发现了链上Alice 的预言机，并向链发起了一个查询交易。

bob 需要支付一定的费用，这个费用会被矿工收取。

bob 同时还需要支付预言机查询费用，这个费用会支付给预言机的账户。

查询交易包括：

- Alice 预言机的地址
- 查询所需要的格式说明
- 矿工所需的费用
- 向Alice 的预言机所支付的币
- 查询存活的时间 (如果Alice 的预言机在指定的时间内没有回复查询，将退还bob 的币)

查询交易会在预言机状态树上创建一个预言机交互对象，这个对象的id 会从查询交易中得到。

为了当他的查询请求有结果时得到通知，bob 在一个节点上，使用预言机交互ID，注册了一个订阅。

当bob 的查询交易被链接受，Alice 的事件订阅就会被触发，并且得到通知。

这个事件包括：

- 发送者账户的地址
- 预言机交互ID

比赛完成后，得到比赛结果。Alice 会在链上发布一个预言机结果。

结果包括：

- 预言机交互对象的ID
- 符合预言机定语的结果

Alice 需要为发布交易而支付费用，这个费用是由矿工来收取。而作为交易的一部分，Alice 的预言机将会获得查询费用。

当响应被链接受，bob 的事件订阅会通知他。

而这个事件包括：

- 预言机交互对象的ID
- 响应结果的内容
- 响应时间的存活时间

现在bob 可以通过以下方式使用这个结果：

- 执行这个预言机交互对象对应的智能合约
- 使用公开的API来获取答案
